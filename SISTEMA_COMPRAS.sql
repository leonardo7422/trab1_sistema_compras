
DROP DATABASE IF EXISTS SISTEMA_COMPRAS;
CREATE DATABASE SISTEMA_COMPRAS;
USE SISTEMA_COMPRAS;


CREATE TABLE IF NOT EXISTS ESTADO (
ID_ESTADO INT NOT NULL PRIMARY KEY,
NOME_ESTADO VARCHAR(50),
SIGLA VARCHAR(2));


CREATE TABLE IF NOT EXISTS CIDADE (
ID_CIDADE INT NOT NULL PRIMARY KEY,
NOME_CIDADE VARCHAR(50),
ID_ESTADO INT,
FOREIGN KEY (ID_ESTADO)
        REFERENCES ESTADO (ID_ESTADO)
        ON UPDATE CASCADE ON DELETE CASCADE);
        
CREATE TABLE IF NOT EXISTS LOJA (
ID_LOJA INT NOT NULL PRIMARY KEY,
CNPJ INT(3),
RAZAO_SOCIAL VARCHAR(50),
NOME_FANTASIA VARCHAR(50),
ID_CIDADE INT,
FOREIGN KEY (ID_CIDADE)
        REFERENCES CIDADE (ID_CIDADE)
        ON UPDATE CASCADE ON DELETE CASCADE);


CREATE TABLE IF NOT EXISTS FORNECEDOR (
ID_FORNECEDOR INT NOT NULL PRIMARY KEY,
RAZAO_SOCIAL VARCHAR(50),
NOME_FANTASIA VARCHAR(20),
ID_CIDADE INT,
FOREIGN KEY (ID_CIDADE)
        REFERENCES CIDADE (ID_CIDADE)
        ON UPDATE CASCADE ON DELETE CASCADE);


CREATE TABLE IF NOT EXISTS PRODUTO (
ID_PRODUTO INT NOT NULL PRIMARY KEY,
NOME VARCHAR(50),
DESCRICAO VARCHAR(20),
PRECO_UNITARIO FLOAT);

CREATE TABLE IF NOT EXISTS COMPRA (
ID_COMPRA INT NOT NULL PRIMARY KEY,
ID_FORNECEDOR INT,
ID_PRODUTO INT,
QUANTIDADE INT,
ID_LOJA INT,
PRECO_UNITARIO FLOAT,
FOREIGN KEY (ID_FORNECEDOR)
        REFERENCES FORNECEDOR (ID_FORNECEDOR)
        ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY (ID_PRODUTO)
        REFERENCES PRODUTO (ID_PRODUTO)
        ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY (ID_LOJA)
        REFERENCES LOJA (ID_LOJA)
        ON UPDATE CASCADE ON DELETE CASCADE);
        
        
INSERT INTO ESTADO VALUES (1,'São Paulo', 'SP');
INSERT INTO ESTADO VALUES (2,'Rio de Janeiro', 'RJ');
INSERT INTO ESTADO VALUES (3,'Minas Gerais', 'MG');
INSERT INTO ESTADO VALUES (4,'Mato Grosso', 'MT');
INSERT INTO ESTADO VALUES (5,'Paraná', 'PR');

INSERT INTO CIDADE VALUES (46,'Araraquara', 1);
INSERT INTO CIDADE VALUES (90,'Nova Iguaçu', 2);
INSERT INTO CIDADE VALUES (87,'Monte Claros', 3);
INSERT INTO CIDADE VALUES (32,'Cuiabá', 4);
INSERT INTO CIDADE VALUES (96,'Curitiba', 5);

INSERT INTO LOJA VALUES (46, 123, 'Renner', 'Renner', 46);
INSERT INTO LOJA VALUES (47, 124, 'Extra', 'Extra', 46);
INSERT INTO LOJA VALUES (48, 324, 'Adidas', 'Adidas', 90);
INSERT INTO LOJA VALUES (49, 545, 'Supreme', 'Supreme', 32);
INSERT INTO LOJA VALUES (50, 675, 'Lupo', 'Lupo', 87);

INSERT INTO FORNECEDOR VALUES (90, 'Mc Donalds Burger', 'Mc Donalds', 46);
INSERT INTO FORNECEDOR VALUES (91,'Coca-Cola', 'Coca', 90);
INSERT INTO FORNECEDOR VALUES (92,'New Balance', 'N', 87);
INSERT INTO FORNECEDOR VALUES (93,'Rexona', 'Rexona', 32);
INSERT INTO FORNECEDOR VALUES (94,'Yoki', 'Yoki', 96);

INSERT INTO PRODUTO VALUES (65,'Fone de Ouvido', 'Stereo Auricular', 80.00);
INSERT INTO PRODUTO VALUES (66,'Video-Game', NULL , 600.00);
INSERT INTO PRODUTO VALUES (67,'Chuveiro', 'Com Regulador de Temperatura' , 150.00);
INSERT INTO PRODUTO VALUES (68,'Bicicleta', 'Com marcha', 1200.00);
INSERT INTO PRODUTO VALUES (69,'Estojo', 'Com 2 zipers', 30.00);

INSERT INTO COMPRA VALUES (23, 90, 65, 1, 46, 80.00);
INSERT INTO COMPRA VALUES (24, 91, 67, 5, 46, 1100.00);
INSERT INTO COMPRA VALUES (25, 92, 69, 3, 46, 150.00);
INSERT INTO COMPRA VALUES (26, 93, 65, 12, 46, 700.00);
INSERT INTO COMPRA VALUES (27, 94, 66, 9, 46, 25.00);




        SELECT * FROM fornecedor ORDER BY ID_FORNECEDOR;
        
        SELECT FORNECEDOR.ID_CIDADE AS value, NOME_CIDADE AS texto FROM cidade, fornecedor WHERE FORNECEDOR.ID_CIDADE = CIDADE.ID_CIDADE;
        
        SELECT * FROM compra;
        
        SELECT * FROM loja ORDER BY ID_LOJA